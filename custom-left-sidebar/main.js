/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var V=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var F=(a,e)=>{for(var t in e)V(a,t,{get:e[t],enumerable:!0})},z=(a,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of H(e))!R.call(a,n)&&n!==t&&V(a,n,{get:()=>e[n],enumerable:!(i=L(e,n))||i.enumerable});return a};var W=a=>z(V({},"__esModule",{value:!0}),a);var U={};F(U,{default:()=>E});module.exports=W(U);function o(a,e,t,i){function n(s){return s instanceof t?s:new t(function(r){r(s)})}return new(t||(t=Promise))(function(s,r){function c(l){try{h(i.next(l))}catch(u){r(u)}}function d(l){try{h(i.throw(l))}catch(u){r(u)}}function h(l){l.done?s(l.value):n(l.value).then(c,d)}h((i=i.apply(a,e||[])).next())})}var D=require("obsidian");var T=require("obsidian"),x="CommandType";function _(a){let e=[],t=a.split(`
`),i=0;for(;i<t.length;){let s=t[i].match(/^```([^\s]+)\s+(.+)$/);if(s){let[,r,c]=s,d=i+1,h=1,l=-1;for(let u=d;u<t.length;u++)if(t[u].startsWith("```")&&t[u].length===3){if(h--,h===0){l=u;break}}else t[u].startsWith("```")&&h++;if(l>-1){let u=t.slice(d,l).join(`
`);e.push({type:r,key:c,content:u}),i=l+1}else i++}else i++}return e}function I(a){return a.toLowerCase().replace(/[^a-z0-9]/g,"-")}var P={viewOptions:[],hasValidDsl:!1};function A(a){return _(a).filter(t=>t.type===x).map(t=>({id:I(t.key),label:t.key.trim(),content:t.content.trim()}))}function f(a){try{let t=_(a).filter(i=>i.type===x).map(i=>{let n=i.content.trim(),s=A(n),r=s.length>0;return Object.assign({id:I(i.key),label:i.key.trim(),content:n},r&&{subOptions:s,hasNestedDsl:!0})});return t.length===0?P:{viewOptions:t,hasValidDsl:!0}}catch(e){return new T.Notice(`DSL parsing error: ${e.message}`),P}}function S(a){return _(a).some(t=>t.type===x)}var m=class extends D.Plugin{constructor(){super(...arguments),this.registeredDynamicCommands=[],this.lastContentHash=null}onload(){return o(this,void 0,void 0,function*(){yield this.loadSettings();let e=this.getViewConfig();this.registerView(e.viewType,t=>this.createView(t,()=>this.settings)),this.addSettingTab(this.createSettingsTab()),this.settings.showRibbonIcon&&this.addRibbonIcon(e.ribbonIcon,e.ribbonTooltip,()=>o(this,void 0,void 0,function*(){yield this.activateView()})),this.addCommand({id:e.commandId,name:e.commandName,checkCallback:t=>{if(t)return!0;this.activateView()}}),this.registerEvent(this.app.workspace.on("active-leaf-change",()=>{this.updateActiveViews(),setTimeout(()=>this.updateDynamicCommands(),100)})),this.registerEvent(this.app.workspace.on("layout-change",()=>{setTimeout(()=>this.updateDynamicCommands(),200)})),setTimeout(()=>{this.updateDynamicCommands()},500),yield this.onPluginLoad()})}onunload(){return o(this,void 0,void 0,function*(){let e=this.getViewConfig();this.app.workspace.getLeavesOfType(e.viewType).forEach(t=>{t.detach()}),yield this.onPluginUnload()})}loadSettings(){return o(this,void 0,void 0,function*(){this.settings=Object.assign({},this.getDefaultSettings(),yield this.loadData())})}saveSettings(){return o(this,void 0,void 0,function*(){yield this.saveData(this.settings),setTimeout(()=>this.updateDynamicCommands(),100)})}getContentForCurrentContext(){var e,t;let i=this.app.workspace.getActiveFile();if(!i)return(e=this.onContentChange)===null||e===void 0||e.call(this,"",""),{content:"",filePath:""};let n=i.path,s=this.settings.directoryMappings,r=s.find(d=>n.startsWith(d.directoryPath))||s.find(d=>d.directoryPath==="*"),c=(r==null?void 0:r.content)||"";return(t=this.onContentChange)===null||t===void 0||t.call(this,c,n),{content:c,filePath:n}}parseContentIfNeeded(e){if(S(e)){let t=f(e);return{content:e,hasValidDsl:t.hasValidDsl,viewOptions:t.viewOptions}}return{content:e,hasValidDsl:!1}}activateView(){return o(this,void 0,void 0,function*(){let e=this.getViewConfig(),t=this.app.workspace.getLeavesOfType(e.viewType);if(t.length>0){this.app.workspace.revealLeaf(t[0]);return}let i=e.sidebarSide==="left"?this.app.workspace.getLeftLeaf(!1):this.app.workspace.getRightLeaf(!1);i&&(yield i.setViewState({type:e.viewType,active:!0}),this.app.workspace.revealLeaf(i))})}updateActiveViews(){let e=this.getViewConfig();this.app.workspace.getLeavesOfType(e.viewType).forEach(i=>{let n=i.view;n&&"updateContent"in n&&typeof n.updateContent=="function"&&n.updateContent()})}onPluginLoad(){return o(this,void 0,void 0,function*(){})}onPluginUnload(){return o(this,void 0,void 0,function*(){})}updateDynamicCommands(){let{content:e}=this.getContentForCurrentContext(),t=this.getViewSwitchingManager();if(!t){this.clearDynamicCommands(),this.lastContentHash=null;return}let i=t.getCurrentViewOptions(),n=this.createViewStateHash(i,t),r=`${e?this.simpleHash(e):null}|${n}`;if(r===this.lastContentHash||(this.lastContentHash=r,this.clearDynamicCommands(),!e||!S(e)))return;"onCommandsNeedUpdate"in t&&(t.onCommandsNeedUpdate=()=>{setTimeout(()=>{this.lastContentHash=null,this.updateDynamicCommands()},50)});let c=t.getAvailableCommands();this.registerDynamicCommands(c,t)}getViewSwitchingManager(){let e=this.getViewConfig(),t=this.app.workspace.getLeavesOfType(e.viewType);if(t.length===0)return null;let i=t[0].view;return i&&"getViewSwitchingManager"in i&&typeof i.getViewSwitchingManager=="function"?i.getViewSwitchingManager():null}registerDynamicCommands(e,t){let i=this.getViewConfig();for(let n of e){let s=`${i.commandId}-${n.id}`;this.addCommand({id:s,name:n.name,checkCallback:r=>{if(r)return this.getViewSwitchingManager()!==null;let c=this.getViewSwitchingManager();if(!c)return!1;let h=c.getAvailableCommands().find(l=>l.id===n.id);return h&&c.switchToView(h.viewId,h.subViewId),!0}}),this.registeredDynamicCommands.push(s)}}clearDynamicCommands(){this.registeredDynamicCommands=[]}simpleHash(e){let t=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);t=(t<<5)-t+n,t=t&t}return t.toString()}createViewStateHash(e,t){let n=t.getAvailableCommands().map(s=>`${s.id}:${s.viewId}:${s.subViewId||""}`).join("|");return this.simpleHash(n)}forceUpdateDynamicCommands(){this.lastContentHash=null,this.updateDynamicCommands()}};var p=require("obsidian"),g=class extends p.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:this.getTitle()}),e.createEl("h3",{text:"General Settings"}),this.displayGeneralSettings(e),e.createEl("h3",{text:"Directory Mappings"}),this.displayDirectoryMappings(e),e.createEl("h3",{text:"DSL Syntax"});let t=e.createEl("div",{cls:"setting-item-description"});t.innerHTML="\n			<p><strong>DSL Syntax Examples:</strong></p>\n\n			<p><em>Basic Syntax:</em></p>\n			<pre><code>```CommandType Tasks\n![[Projects-Tasks.base]]\n```\n\n```CommandType ChildTasks\n![[Projects-ChildTasks.base]]\n```</code></pre>\n\n			<p><em>Nested Syntax (Two-Level Dropdowns):</em></p>\n			<pre><code>```CommandType Projects\n# Project Overview\n\n```CommandType CurrentProjects\n![[Projects-Current.base]]\n```\n\n```CommandType CompletedProjects\n![[Projects-Completed.base]]\n```\n\n```CommandType OnHoldProjects\n![[Projects-OnHold.base]]\n```\n```</code></pre>\n\n			<p>The <strong>CommandType</strong> creates the main dropdown selector. When nested <strong>CommandType</strong> blocks are within another CommandType, a second dropdown will appear for sub-views.</p>\n			<p><strong>Note:</strong> You can mix regular content with nested CommandType blocks within CommandType sections.</p>\n		",e.createEl("h3",{text:"Dynamic Commands"});let i=e.createEl("div",{cls:"setting-item-description"});i.innerHTML=`
			<p><strong>Dynamic View Switching Commands:</strong></p>
			<p>When DSL content is detected, the plugin automatically registers commands for each view option:</p>
			<ul>
				<li><strong>Main Views:</strong> "Switch to [ViewName]" - Switch to top-level views</li>
				<li><strong>Sub-Views:</strong> "Switch to [ViewName] \u2192 [SubViewName]" - Switch to nested views</li>
			</ul>
			<p>These commands are dynamically created based on your DSL content and can be assigned hotkeys in Obsidian's hotkey settings.</p>
			<p><strong>Command Naming:</strong> Commands use consistent IDs based on your view names, so hotkey assignments persist across content changes.</p>
		`,e.createEl("h3",{text:"Usage"});let n=e.createEl("div",{cls:"setting-item-description"});n.innerHTML=this.getUsageText()}displayGeneralSettings(e){new p.Setting(e).setName("Show Ribbon Icon").setDesc("Display the ribbon icon in the sidebar for quick access to the view").addToggle(t=>t.setValue(this.plugin.settings.showRibbonIcon).onChange(i=>o(this,void 0,void 0,function*(){this.plugin.settings.showRibbonIcon=i,yield this.plugin.saveSettings(),new p.Notice("Ribbon icon setting changed. Please reload the plugin or restart Obsidian to see the changes.")})))}displayDirectoryMappings(e){let t=e.createEl("div",{cls:"setting-item-description"});t.innerHTML=`
			<p><strong>Directory Mappings:</strong> Configure what content to display for different directory paths in the ${this.getSidebarName()}.</p>
			<p>Use "*" as the directory path for a default fallback. More specific paths take priority.</p>
		`;let i=this.plugin.settings.directoryMappings;for(let n of i)this.createMappingRow(e,n);new p.Setting(e).setName("Add Directory Mapping").setDesc(`Add a new directory to content mapping for the ${this.getSidebarName()}`).addButton(n=>n.setButtonText("Add Mapping").setCta().onClick(()=>o(this,void 0,void 0,function*(){let s={id:Date.now().toString(),directoryPath:"",content:""};this.plugin.settings.directoryMappings.push(s),yield this.plugin.saveSettings(),this.display()})))}createMappingRow(e,t){let i=e.createEl("div",{cls:"directory-mapping-row"});new p.Setting(i).setName("Directory Path").setDesc("Path to match (e.g., 'Goals', 'Projects', or '*' for default)").addText(n=>n.setPlaceholder("Goals").setValue(t.directoryPath).onChange(s=>o(this,void 0,void 0,function*(){t.directoryPath=s.trim(),yield this.plugin.saveSettings()}))).addExtraButton(n=>n.setIcon("trash").setTooltip("Remove this mapping").onClick(()=>o(this,void 0,void 0,function*(){let s=this.plugin.settings.directoryMappings,r=s.indexOf(t);r>-1&&(s.splice(r,1),yield this.plugin.saveSettings(),this.display())}))),new p.Setting(i).setName("Content to Render").setDesc("Markdown content to display for this directory (supports embeds, links, etc.)").addTextArea(n=>{n.setPlaceholder("![[Templates/Links]]").setValue(t.content).onChange(s=>o(this,void 0,void 0,function*(){t.content=s,yield this.plugin.saveSettings()})),n.inputEl.style.width="100%",n.inputEl.style.minWidth="400px",n.inputEl.style.height="120px",n.inputEl.style.resize="vertical",n.inputEl.style.fontFamily="var(--font-monospace)"}),i.createEl("hr",{cls:"directory-mapping-separator"})}};var C=require("obsidian");var M=require("obsidian");var O=class{constructor(){this.cache=new Map}getViewSelection(e){return e&&this.cache.get(e)||null}setViewSelection(e,t){e&&this.cache.set(e,{selectedViewId:t.selectedViewId,selectedSubViewId:t.selectedSubViewId})}hasCache(e){return e?this.cache.has(e):!1}clearCache(){this.cache.clear()}removeCache(e){return e?this.cache.delete(e):!1}getCachedFilePaths(){return Array.from(this.cache.keys())}getCacheSize(){return this.cache.size}clearCacheByPattern(e){let t=0;for(let i of this.cache.keys())e.test(i)&&(this.cache.delete(i),t++);return t}updateViewSelection(e,t){var i,n;if(!e||!this.hasCache(e))return!1;let s=this.cache.get(e);return this.cache.set(e,{selectedViewId:"selectedViewId"in t?(i=t.selectedViewId)!==null&&i!==void 0?i:null:s.selectedViewId,selectedSubViewId:"selectedSubViewId"in t?(n=t.selectedSubViewId)!==null&&n!==void 0?n:null:s.selectedSubViewId}),!0}};function k(){return new O}var w=class{constructor(e,t,i,n,s,r){this.app=e,this.runtimeState=t,this.component=i,this.getSettings=n,this.sidebarEl=null,this.contentEl=null,this.resizeHandle=null,this.viewSelectorEl=null,this.isResizing=!1,this.startX=0,this.startWidth=0,this.currentParsedContent=null,this.selectedViewId=null,this.selectedSubViewId=null,this.isUpdating=!1,this.containerEl=null,this.lastContentHash=null,this.lastFilePath=null,this.subViewSelectorEl=null,this.config={side:(s==null?void 0:s.side)||"left",defaultWidth:(s==null?void 0:s.defaultWidth)||300,minWidth:(s==null?void 0:s.minWidth)||200},this.containerEl=r||null,this.viewCache=k()}show(){this.sidebarEl||(this.containerEl?this.createEmbeddedSidebar():(this.createSidebarContainer(),this.createResizeHandle(),this.createViewSelector(),this.createSubViewSelector(),this.createContentArea(),this.setupResizeHandlers(),document.body.appendChild(this.sidebarEl),document.body.addClass("custom-sidebar-visible")),this.updateContent())}createEmbeddedSidebar(){this.containerEl&&(this.sidebarEl=this.containerEl,this.sidebarEl.addClass("custom-sidebar-embedded"),this.createViewSelector(),this.createSubViewSelector(),this.createContentArea())}hide(){this.sidebarEl&&(this.containerEl?this.sidebarEl.empty():(this.sidebarEl.remove(),document.body.removeClass("custom-sidebar-visible")),this.sidebarEl=null,this.contentEl=null,this.resizeHandle=null,this.viewSelectorEl=null,this.subViewSelectorEl=null),this.isUpdating=!1}clearCache(){this.viewCache.clearCache()}getCachedSelection(e){return this.viewCache.getViewSelection(e)}updateContent(){return o(this,void 0,void 0,function*(){if(!(!this.contentEl||this.isUpdating)){this.isUpdating=!0;try{let e=this.app.workspace.getActiveFile(),t=(e==null?void 0:e.path)||"";if(t===this.lastFilePath&&this.currentParsedContent)return;let i=this.getContentForCurrentFile(),n=`|selectedView:${this.selectedViewId}|selectedSubView:${this.selectedSubViewId}`,s=`${i}${n}`,r=i?this.simpleHash(s):null;if(r===this.lastContentHash&&this.currentParsedContent){this.lastFilePath=t;return}if(this.contentEl.empty(),this.lastContentHash=r,this.lastFilePath=t,!i){this.contentEl.createEl("div",{text:"No content configured for this directory",cls:"custom-sidebar-no-content"}),this.hideViewSelectors();return}this.currentParsedContent=f(i),this.currentParsedContent.hasValidDsl?(this.restoreCachedSelections(t),this.updateViewSelector(this.currentParsedContent.viewOptions),!this.viewCache.hasCache(t)&&this.selectedViewId&&this.saveCachedSelections(t),yield this.renderSelectedView()):(this.hideViewSelectors(),yield this.renderContent(i,this.contentEl))}catch(e){console.error("Failed to update sidebar content:",e),this.contentEl.empty(),this.contentEl.createEl("div",{text:"Error loading sidebar content",cls:"custom-sidebar-error"}),this.hideViewSelectors()}finally{this.isUpdating=!1}}})}getContentForCurrentFile(){let e=this.app.workspace.getActiveFile();if(!e)return null;let t=this.getSettings(),i=e.path,n=null;for(let s of t.directoryMappings){if(s.directoryPath==="*"){n=s.content;continue}if(this.doesPathMatch(i,s.directoryPath))return s.content||null}return n}doesPathMatch(e,t){if(!t)return!1;let i=t.endsWith("/")?t:`${t}/`;return e.startsWith(i)}createSidebarContainer(){this.sidebarEl=document.createElement("div"),this.sidebarEl.addClass("custom-sidebar-container");let e=this.config.side==="left"?{left:"0"}:{right:"0"};Object.assign(this.sidebarEl.style,Object.assign({width:`${this.runtimeState.currentWidth}px`,backgroundColor:"var(--background-primary)",position:"fixed",top:"0",bottom:"0",zIndex:"50",overflow:"hidden",boxShadow:this.config.side==="left"?"2px 0 8px rgba(0, 0, 0, 0.1)":"-2px 0 8px rgba(0, 0, 0, 0.1)",pointerEvents:"auto"},e)),this.config.side==="left"?this.sidebarEl.style.borderRight="1px solid var(--background-modifier-border)":this.sidebarEl.style.borderLeft="1px solid var(--background-modifier-border)"}createResizeHandle(){this.resizeHandle=document.createElement("div"),this.resizeHandle.addClass("custom-sidebar-resize-handle");let e=this.config.side==="left"?{right:"0"}:{left:"0"};Object.assign(this.resizeHandle.style,Object.assign({position:"absolute",top:"0",bottom:"0",width:"6px",backgroundColor:"var(--background-modifier-border)",cursor:"ew-resize",zIndex:"60",transition:"background-color 0.2s ease"},e)),this.resizeHandle.addEventListener("mouseenter",()=>{this.resizeHandle.style.backgroundColor="var(--interactive-accent)"}),this.resizeHandle.addEventListener("mouseleave",()=>{this.isResizing||(this.resizeHandle.style.backgroundColor="var(--background-modifier-border)")}),this.sidebarEl.appendChild(this.resizeHandle)}createViewSelector(){this.viewSelectorEl=document.createElement("div"),this.viewSelectorEl.addClass("custom-sidebar-view-selector");let e=this.config.side==="left"?"marginRight":"marginLeft";Object.assign(this.viewSelectorEl.style,{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-secondary)",[e]:"6px",display:"none"}),this.sidebarEl.appendChild(this.viewSelectorEl)}createSubViewSelector(){this.subViewSelectorEl=document.createElement("div"),this.subViewSelectorEl.addClass("custom-sidebar-subview-selector");let e=this.config.side==="left"?"marginRight":"marginLeft";Object.assign(this.subViewSelectorEl.style,{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-secondary)",[e]:"6px",display:"none"}),this.sidebarEl.appendChild(this.subViewSelectorEl)}createContentArea(){if(this.contentEl=document.createElement("div"),this.contentEl.addClass("custom-sidebar-content"),this.containerEl)Object.assign(this.contentEl.style,{padding:"12px",height:"calc(100% - 0px)",overflow:"auto",position:"relative"});else{let e=this.config.side==="left"?"marginRight":"marginLeft";Object.assign(this.contentEl.style,{padding:"12px",width:`${this.runtimeState.currentWidth-6}px`,height:"calc(100% - 0px)",overflow:"auto",[e]:"6px",pointerEvents:"auto",position:"relative"})}this.sidebarEl.appendChild(this.contentEl)}setupResizeHandlers(){if(!this.resizeHandle)return;let e=n=>{n.preventDefault(),this.isResizing=!0,this.startX=n.clientX,this.startWidth=this.runtimeState.currentWidth,document.body.style.cursor="ew-resize",document.body.style.userSelect="none",this.resizeHandle.style.backgroundColor="var(--interactive-accent)"},t=n=>{if(!this.isResizing)return;n.preventDefault();let s=this.config.side==="left"?n.clientX-this.startX:this.startX-n.clientX,r=Math.max(this.config.minWidth,this.startWidth+s);this.runtimeState.currentWidth=r,this.sidebarEl&&this.contentEl&&(this.sidebarEl.style.width=`${r}px`,this.contentEl.style.width=`${r-6}px`)},i=()=>{this.isResizing&&(this.isResizing=!1,document.body.style.cursor="",document.body.style.userSelect="",this.resizeHandle.style.backgroundColor="var(--background-modifier-border)")};this.resizeHandle.addEventListener("mousedown",e),this.component.registerDomEvent(document,"mousemove",t),this.component.registerDomEvent(document,"mouseup",i)}renderContent(e,t){return o(this,void 0,void 0,function*(){let i=document.createElement("div"),n=this.app.workspace.getActiveFile(),s=(n==null?void 0:n.path)||"";for(yield M.MarkdownRenderer.render(this.app,e,i,s,this.component);i.firstChild;)t.appendChild(i.firstChild)})}updateViewSelector(e){if(!this.viewSelectorEl)return;this.viewSelectorEl.empty();let t=document.createElement("select");t.addClass("custom-sidebar-view-select"),Object.assign(t.style,{width:"100%",padding:"4px 8px",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-normal)"});for(let n of e){let s=document.createElement("option");s.value=n.id,s.textContent=n.label,t.appendChild(s)}let i=this.selectedViewId;(!i||!e.find(n=>n.id===i))&&(i=e.length>0?e[0].id:null),i&&(this.selectedViewId=i,t.value=i),t.addEventListener("change",n=>o(this,void 0,void 0,function*(){var s;let r=n.target;this.selectedViewId=r.value||null,this.selectedSubViewId=null;let c=this.app.workspace.getActiveFile();c&&this.saveCachedSelections(c.path),this.updateSubViewSelector(),this.updateContentHeight(),(s=this.onCommandsNeedUpdate)===null||s===void 0||s.call(this),yield this.renderSelectedView()})),this.viewSelectorEl.appendChild(t),this.updateViewSelectors()}updateViewSelectors(){!this.viewSelectorEl||!this.contentEl||(this.viewSelectorEl.style.display="block",this.updateSubViewSelector(),this.updateContentHeight())}updateSubViewSelector(){if(!this.subViewSelectorEl||!this.currentParsedContent||!this.selectedViewId){this.hideSubViewSelector();return}let e=this.currentParsedContent.viewOptions.find(n=>n.id===this.selectedViewId);if(!e||!e.hasNestedDsl||!e.subOptions){this.hideSubViewSelector();return}this.subViewSelectorEl.empty();let t=document.createElement("select");t.addClass("custom-sidebar-subview-select"),Object.assign(t.style,{width:"100%",padding:"4px 8px",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-normal)"});for(let n of e.subOptions){let s=document.createElement("option");s.value=n.id,s.textContent=n.label,t.appendChild(s)}let i=this.selectedSubViewId;(!i||!e.subOptions.find(n=>n.id===i))&&(i=e.subOptions.length>0?e.subOptions[0].id:null),i&&(this.selectedSubViewId=i,t.value=i),t.addEventListener("change",n=>o(this,void 0,void 0,function*(){let s=n.target;this.selectedSubViewId=s.value||null;let r=this.app.workspace.getActiveFile();r&&this.saveCachedSelections(r.path),yield this.renderSelectedView()})),this.subViewSelectorEl.appendChild(t),this.showSubViewSelector()}showSubViewSelector(){this.subViewSelectorEl&&(this.subViewSelectorEl.style.display="block")}hideSubViewSelector(){this.subViewSelectorEl&&(this.subViewSelectorEl.style.display="none")}updateContentHeight(){if(!this.contentEl)return;let e=0;this.viewSelectorEl&&this.viewSelectorEl.style.display==="block"&&(e+=45),this.subViewSelectorEl&&this.subViewSelectorEl.style.display==="block"&&(e+=45),this.contentEl.style.height=`calc(100% - ${e}px)`}hideViewSelectors(){!this.viewSelectorEl||!this.contentEl||(this.viewSelectorEl.style.display="none",this.hideSubViewSelector(),this.contentEl.style.height="calc(100% - 0px)")}renderSelectedView(){return o(this,void 0,void 0,function*(){if(!this.contentEl||!this.currentParsedContent||!this.selectedViewId)return;let e=this.currentParsedContent.viewOptions.find(t=>t.id===this.selectedViewId);if(!e){this.contentEl.empty(),this.contentEl.createEl("div",{text:"Selected view not found",cls:"custom-sidebar-error"});return}this.contentEl.empty();try{let t;if(e.hasNestedDsl&&e.subOptions&&this.selectedSubViewId){let i=e.subOptions.find(n=>n.id===this.selectedSubViewId);i?t=i.content:t=e.content}else t=e.content;yield this.renderContent(t,this.contentEl)}catch(t){console.error("Error rendering selected view:",t),this.contentEl.empty(),this.contentEl.createEl("div",{text:"Error rendering view content",cls:"custom-sidebar-error"})}})}simpleHash(e){let t=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);t=(t<<5)-t+n,t=t&t}return t.toString()}restoreCachedSelections(e){var t;if(!e||!(!((t=this.currentParsedContent)===null||t===void 0)&&t.hasValidDsl))return;let i=this.viewCache.getViewSelection(e);if(!i){this.selectedViewId=this.currentParsedContent.viewOptions.length>0?this.currentParsedContent.viewOptions[0].id:null,this.selectedSubViewId=null;return}let n=this.currentParsedContent.viewOptions.find(s=>s.id===i.selectedViewId);n?(this.selectedViewId=i.selectedViewId,i.selectedSubViewId&&n.subOptions?n.subOptions.find(r=>r.id===i.selectedSubViewId)?this.selectedSubViewId=i.selectedSubViewId:this.selectedSubViewId=n.subOptions.length>0?n.subOptions[0].id:null:this.selectedSubViewId=null):(this.selectedViewId=this.currentParsedContent.viewOptions.length>0?this.currentParsedContent.viewOptions[0].id:null,this.selectedSubViewId=null)}saveCachedSelections(e){var t;!e||!(!((t=this.currentParsedContent)===null||t===void 0)&&t.hasValidDsl)||this.selectedViewId&&this.viewCache.setViewSelection(e,{selectedViewId:this.selectedViewId,selectedSubViewId:this.selectedSubViewId})}switchToView(e,t){return o(this,void 0,void 0,function*(){var i;if(!(!((i=this.currentParsedContent)===null||i===void 0)&&i.hasValidDsl)){console.warn("Cannot switch view: No DSL content available");return}let n=this.currentParsedContent.viewOptions.find(r=>r.id===e);if(!n){console.warn(`Cannot switch to view: View '${e}' not found`);return}if(t&&n.subOptions&&!n.subOptions.find(c=>c.id===t)){console.warn(`Cannot switch to sub-view: Sub-view '${t}' not found in view '${e}'`);return}this.selectedViewId=e,this.selectedSubViewId=t||null;let s=this.app.workspace.getActiveFile();s&&this.saveCachedSelections(s.path),this.updateViewSelectorValue(e),this.updateSubViewSelector(),t&&this.updateSubViewSelectorValue(t),this.updateContentHeight(),yield this.renderSelectedView()})}getCurrentViewOptions(){var e;return((e=this.currentParsedContent)===null||e===void 0?void 0:e.viewOptions)||[]}getAvailableCommands(){var e;let t=[];if(!(!((e=this.currentParsedContent)===null||e===void 0)&&e.hasValidDsl))return t;let i=1;for(let s=0;s<this.currentParsedContent.viewOptions.length;s++){let r=this.currentParsedContent.viewOptions[s],c=s+1,d={id:`switch-to-main-${c}`,name:`Switch to Main ${c}`,viewId:r.id,index:i++};t.push(d)}let n=this.getCurrentMainView();if(n!=null&&n.hasNestedDsl&&n.subOptions)for(let s=0;s<n.subOptions.length;s++){let r=n.subOptions[s],c=s+1,d={id:`switch-to-nested-${c}`,name:`Switch to Nested ${c}`,viewId:n.id,subViewId:r.id,index:i++};t.push(d)}return t}getCurrentMainView(){var e;return!(!((e=this.currentParsedContent)===null||e===void 0)&&e.hasValidDsl)||!this.selectedViewId?null:this.currentParsedContent.viewOptions.find(t=>t.id===this.selectedViewId)||null}updateViewSelectorValue(e){if(!this.viewSelectorEl)return;let t=this.viewSelectorEl.querySelector("select");t&&(t.value=e)}updateSubViewSelectorValue(e){if(!this.subViewSelectorEl)return;let t=this.subViewSelectorEl.querySelector("select");t&&(t.value=e)}};var b=class extends C.ItemView{constructor(e,t,i,n){super(e),this.getSettings=t,this.sidebarType=i,this.pluginId=n,this.isUpdating=!1,this.sidebarManager=null,this.runtimeState={isVisible:!0,currentWidth:300}}getPlugin(){var e;return(e=this.app.plugins)===null||e===void 0?void 0:e.getPlugin(this.pluginId)}onOpen(){return o(this,void 0,void 0,function*(){let e=this.containerEl;e.empty(),this.container=e.createDiv({cls:"custom-sidebar-root"}),this.sidebarContentEl=this.container.createDiv({cls:"custom-sidebar-content"}),this.sidebarManager=new w(this.app,this.runtimeState,this,this.getSettings,{side:this.sidebarType},this.sidebarContentEl),this.sidebarManager.show()})}onClose(){return o(this,void 0,void 0,function*(){this.sidebarManager&&(this.sidebarManager.hide(),this.sidebarManager=null),this.isUpdating=!1})}getState(){let e=this.app.workspace.getActiveFile();return{currentPath:e==null?void 0:e.path}}setState(e,t){let i=Object.create(null,{setState:{get:()=>super.setState}});return o(this,void 0,void 0,function*(){yield i.setState.call(this,e,t),yield this.updateContent()})}updateContent(){return o(this,void 0,void 0,function*(){if(!(!this.sidebarManager||this.isUpdating)){this.isUpdating=!0;try{yield this.sidebarManager.updateContent()}catch(e){console.error("Failed to update sidebar content:",e),this.sidebarContentEl&&(this.sidebarContentEl.empty(),this.sidebarContentEl.createEl("div",{text:"Error loading sidebar content",cls:"custom-sidebar-error"}))}finally{this.isUpdating=!1}}})}renderContent(e,t){return o(this,void 0,void 0,function*(){let i=document.createElement("div"),n=this.app.workspace.getActiveFile(),s=(n==null?void 0:n.path)||"";for(yield C.MarkdownRenderer.render(this.app,e,i,s,this);i.firstChild;)t.appendChild(i.firstChild)})}getViewSwitchingManager(){return this.sidebarManager}};var N="custom-left-sidebar-view",v=class extends b{constructor(e,t){super(e,t,"left","custom-left-sidebar")}getViewType(){return N}getDisplayText(){return"Custom Left Sidebar"}getIcon(){return"sidebar-left"}};var y=class extends g{getTitle(){return"Custom Left Sidebar Settings"}getSidebarName(){return"left sidebar"}getUsageText(){return`
			<p><strong>Open Sidebar:</strong> Use the ribbon icon or command "Open Custom Left Sidebar" to open the left sidebar.</p>
			<p><strong>Resize Sidebar:</strong> Drag the edges of the sidebar to resize it. Obsidian handles the sizing automatically.</p>
			<p><strong>Hotkeys:</strong> Left sidebar: Ctrl/Cmd+Shift+L</p>
		`}};var j={directoryMappings:[],showRibbonIcon:!1};var $="custom-left-sidebar-view",E=class extends m{createView(e,t){return new v(e,t)}getViewConfig(){return{viewType:$,displayName:"Custom Left Sidebar",ribbonIcon:"sidebar-left",ribbonTooltip:"Open Custom Left Sidebar",commandId:"open-custom-left-sidebar",commandName:"Open Custom Left Sidebar",sidebarSide:"left"}}getDefaultSettings(){return j}createSettingsTab(){return new y(this.app,this)}};
